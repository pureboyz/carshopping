<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org/DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
<mapper namespace="com.cars.dao.AdminDao">
	<select id="lamborghiniByAges" resultType="int">
		SELECT count(A.orderNo) FROM
		(SELECT buy.orderNo FROM buy, member, car
		WHERE (buy.isBuy = 1 OR buy.isBuy = 2)
		AND buy.carNo = car.carNo AND car.carComp = 'lamborghini'
		AND buy.mNo = member.mNo AND member.mAge LIKE CONCAT(#{i},'%')) A
	</select>
	
	<select id="lambirghiniTotal" resultType="int">
		SELECT count(buy.orderNo) FROM buy, car
		WHERE (buy.isBuy = 1 OR buy.isBuy = 2)
		AND buy.carNo = car.carNo AND car.carComp = 'lamborghini'
	</select>
	
	<select id="benzByAges" resultType="int">
		SELECT count(A.orderNo) FROM
		(SELECT buy.orderNo FROM buy, member, car
		WHERE (buy.isBuy = 1 OR buy.isBuy = 2)
		AND buy.carNo = car.carNo AND car.carComp = 'benz'
		AND buy.mNo = member.mNo AND member.mAge LIKE CONCAT(#{i},'%')) A
	</select>
	
	<select id="benzTotal" resultType="int">
		SELECT count(buy.orderNo) FROM buy, car
		WHERE (buy.isBuy = 1 OR buy.isBuy = 2)
		AND buy.carNo = car.carNo AND car.carComp = 'benz'
	</select>
	
	<select id="audiByAges" resultType="int">
		SELECT count(A.orderNo) FROM
		(SELECT buy.orderNo FROM buy, member, car
		WHERE (buy.isBuy = 1 OR buy.isBuy = 2)
		AND buy.carNo = car.carNo AND car.carComp = 'audi'
		AND buy.mNo = member.mNo AND member.mAge LIKE CONCAT(#{i},'%')) A
	</select>
	
	<select id="audiTotal" resultType="int">
		SELECT count(buy.orderNo) FROM buy, car
		WHERE (buy.isBuy = 1 OR buy.isBuy = 2)
		AND buy.carNo = car.carNo AND car.carComp = 'audi'
	</select>
	
	<select id="bmwByAges" resultType="int">
		SELECT count(A.orderNo) FROM
		(SELECT buy.orderNo FROM buy, member, car
		WHERE (buy.isBuy = 1 OR buy.isBuy = 2)
		AND buy.carNo = car.carNo AND car.carComp = 'bmw'
		AND buy.mNo = member.mNo AND member.mAge LIKE CONCAT(#{i},'%')) A
	</select>
	
	<select id="bmwTotal" resultType="int">
		SELECT count(buy.orderNo) FROM buy, car
		WHERE (buy.isBuy = 1 OR buy.isBuy = 2)
		AND buy.carNo = car.carNo AND car.carComp = 'bmw'
	</select>
	
	<select id="toyotaByAges" resultType="int">
		SELECT count(A.orderNo) FROM
		(SELECT buy.orderNo FROM buy, member, car
		WHERE (buy.isBuy = 1 OR buy.isBuy = 2)
		AND buy.carNo = car.carNo AND car.carComp = 'toyota'
		AND buy.mNo = member.mNo AND member.mAge LIKE CONCAT(#{i},'%')) A
	</select>
	
	<select id="toyotaTotal" resultType="int">
		SELECT count(buy.orderNo) FROM buy, car
		WHERE (buy.isBuy = 1 OR buy.isBuy = 2)
		AND buy.carNo = car.carNo AND car.carComp = 'toyota'
	</select>
	
	<select id="hyundaiByAges" resultType="int">
		SELECT count(A.orderNo) FROM
		(SELECT buy.orderNo FROM buy, member, car
		WHERE (buy.isBuy = 1 OR buy.isBuy = 2)
		AND buy.carNo = car.carNo AND car.carComp = 'hyundai'
		AND buy.mNo = member.mNo AND member.mAge LIKE CONCAT(#{i},'%')) A
	</select>
	
	<select id="hyundaiTotal" resultType="int">
		SELECT count(buy.orderNo) FROM buy, car
		WHERE (buy.isBuy = 1 OR buy.isBuy = 2)
		AND buy.carNo = car.carNo AND car.carComp = 'hyundai'
	</select>
	
	<select id="genderCompany" resultType="carVo">
		SELECT A.* FROM (SELECT car.* FROM buy, car, member
		WHERE (buy.isBuy = 1 OR buy.isBuy = 2)
		AND buy.carNo = car.carNo
		AND buy.mNo = member.mNo AND member.mGender = #{i}) A
		GROUP BY carNo
		ORDER BY A.carsale DESC, A.carName DESC
		limit 4
	</select>
	
	<select id="allCount" resultType="int">
		SELECT count(*) FROM buy
		WHERE isBuy = 1 OR isBuy = 2
	</select>
	
	<select id="getCountByFuel" resultType="int">
		SELECT count(buy.orderNo) FROM buy, car
		WHERE (buy.isBuy = 1 OR buy.isBuy = 1)
		AND buy.carNo = car.carNo
		AND car.carFuel = #{s}
	</select>
	
</mapper>